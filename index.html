
<html lang="en">
    <head>

    </head>
    <body>

      <div id="dust" style="width:50px; cursor: pointer; height:50px; background-color:ff6666"> dust </div>

      <div id="mirage" style="width:50px; cursor: pointer; height:50px; background-color: #6666ff"> mirage </div>

      <div id="cache" style="width:50px; cursor: pointer; height:50px; background-color: #99ff66"> cache </div>

      <div id="inferno" style="width:50px;cursor: pointer; height:50px; background-color: #ffb84d"> inferno </div>


        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="/socket.io/socket.io.js"></script>

        <script>

        // Create random uuid
        function guid() {
          function s4() {
            return Math.floor((1 + Math.random()) * 0x10000)
            .toString(16)
            .substring(1);
          }
          return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
          s4() + '-' + s4() + s4() + s4();
        }


        var current_position = 0 ;
        var firstClient = 0 ;
        var inCharge = false;

        //Initiate connection to server
        var host = window.location.origin
        var socket = io.connect(host);

        socket.on('connect', function(data) {
          uuid = guid();
          socket.emit('add user', uuid);
          $("#my_uuid").text(uuid);
        });

        socket.on('order_changed',function(data){
          console.log(data + ' gets to choose');

          if ( uuid == data ) {
            $('#rectangle').css('background-color', 'green');
            inCharge = true;
          } else {
            $('#rectangle').css('background-color', 'red');
            inCharge = false;
          }
          $("#position").text(data);
        });

        // Whenever the server emits 'user joined', log it in the chat body
        socket.on('user joined', function (data) {
          console.log(data.username  + ' joined');
        });

        socket.on('user left', function (data) {
          console.log(data.username + ' left');
        });


        // Define buttons
        $('#dust').click(function() {
          if (inCharge) {
            socket.emit('make_selection' , { uuid : $("#my_uuid").text(), map : "dust"} );
          } else {
            console.log ("Tried to click without inCharge");
          }
        });

        $('#mirage').click(function() {
          if (inCharge) {
            socket.emit('make_selection' , { uuid : $("#my_uuid").text(), map : "mirage"});
          }else {
            console.log ("Tried to click without inCharge");
          }
        });

        $('#cache').click(function() {
          if (inCharge) {
            socket.emit('make_selection' , { uuid : $("#my_uuid").text(), map : "cache"});
          }else {
            console.log ("Tried to click without inCharge");
          }
        });

        $('#inferno').click(function() {
          if (inCharge) {
            socket.emit('make_selection' ,  { uuid : $("#my_uuid").text(), map : "inferno"});
          }else {
            console.log ("Tried to click without inCharge");
          }
        });


        </script>


        <div id="rectangle" style="width:50px; height:50px; background-color:red"></div>
        You are number <div id="my_uuid"> Not connected!  </div>
        <br/>
        In command: <div id="position"> ERROR! </div>
    </body>
</html>
